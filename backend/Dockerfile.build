# Build dependencies on Linux for Azure deployment
# Use Node 22 to match .nvmrc (v22.17.1)
FROM node:22-alpine

# Accept FUNCTION_APP as build argument (api or dataflows)
ARG FUNCTION_APP
WORKDIR /build

# Copy package files for the specific function app
COPY function-apps/${FUNCTION_APP}/package.json .

# Install dependencies (will build native modules for Linux)
RUN npm install --production

# Output will be in /build/node_modules
